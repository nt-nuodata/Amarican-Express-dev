{"Edges":[{"id":"e-0","source":"Shortcut_to_Allivet_Daily_Invoice","target":"SQ_Shortcut_to_Allivet_Daily_Invoice","transformationType":"Source Qualifier"},{"id":"e-1","source":"SQ_Shortcut_to_Allivet_Daily_Invoice","target":"Exp_LoadTstmp","transformationType":"Expression"},{"id":"e-2","source":"Exp_LoadTstmp","target":"Shortcut_to_ALLIVET_DAILY_INVOICE_PRE","transformationType":"Target Definition"}],"Nodes":[{"data":{"transformationType":"Source Definition","label":"Shortcut_to_Allivet_Daily_Invoice","queries":["df_0 = spark.sql(\"\"\"SELECT\n  InvoicePostingDate AS InvoicePostingDate,\n  InvoiceCode AS InvoiceCode,\n  TransactionType AS TransactionType,\n  Allivet_Order AS Allivet_Order,\n  PetSmart_Order AS PetSmart_Order,\n  AllivetSku AS AllivetSku,\n  PetSmartSku AS PetSmartSku,\n  UPC AS UPC,\n  UnitsSold AS UnitsSold,\n  ProductCost AS ProductCost,\n  RetailPrice AS RetailPrice,\n  Manufacturer AS Manufacturer,\n  Brand AS Brand,\n  Title AS Title,\n  FreightFee AS FreightFee,\n  PackagingFee AS PackagingFee,\n  DispensingFee AS DispensingFee,\n  shipped_on AS shipped_on,\n  fulfillment_origin_zip_code AS fulfillment_origin_zip_code,\n  shipping_carrier AS shipping_carrier,\n  TrackingNumber AS TrackingNumber,\n  Customer_id AS Customer_id,\n  Pet_name AS Pet_name,\n  Pet_type AS Pet_type,\n  Breed_type AS Breed_type,\n  Pet_gender AS Pet_gender,\n  Pet_is_pregnant AS Pet_is_pregnant,\n  pet_DOB AS pet_DOB,\n  Pet_weight AS Pet_weight,\n  Pet_allergy AS Pet_allergy,\n  Pet_medical_conditions AS Pet_medical_conditions,\n  Vet_clinic_name AS Vet_clinic_name,\n  Veterinary_name AS Veterinary_name,\n  Vet_address AS Vet_address,\n  Vet_city AS Vet_city,\n  Vet_state AS Vet_state,\n  Vet_zip AS Vet_zip,\n  Vet_phone_number AS Vet_phone_number\nFROM\n  Allivet_Daily_Invoice\"\"\")","df_0.createOrReplaceTempView(\"Shortcut_to_Allivet_Daily_Invoice_0\")"]},"id":"Shortcut_to_Allivet_Daily_Invoice","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Qualifier","label":"SQ_Shortcut_to_Allivet_Daily_Invoice","queries":["df_1 = spark.sql(\"\"\"SELECT\n  InvoicePostingDate AS InvoicePostingDate,\n  InvoiceCode AS InvoiceCode,\n  TransactionType AS TransactionType,\n  Allivet_Order AS Allivet_Order,\n  PetSmart_Order AS PetSmart_Order,\n  AllivetSku AS AllivetSku,\n  PetSmartSku AS PetSmartSku,\n  UPC AS UPC,\n  UnitsSold AS UnitsSold,\n  ProductCost AS ProductCost,\n  RetailPrice AS RetailPrice,\n  Manufacturer AS Manufacturer,\n  Brand AS Brand,\n  Title AS Title,\n  FreightFee AS FreightFee,\n  PackagingFee AS PackagingFee,\n  DispensingFee AS DispensingFee,\n  shipped_on AS shipped_on,\n  fulfillment_origin_zip_code AS fulfillment_origin_zip_code,\n  shipping_carrier AS shipping_carrier,\n  TrackingNumber AS TrackingNumber,\n  Customer_id AS Customer_id,\n  Pet_name AS Pet_name,\n  Pet_type AS Pet_type,\n  Breed_type AS Breed_type,\n  Pet_gender AS Pet_gender,\n  pet_DOB AS pet_DOB,\n  Pet_weight AS Pet_weight,\n  Pet_allergy AS Pet_allergy,\n  Pet_medical_conditions AS Pet_medical_conditions,\n  Pet_is_pregnant AS Pet_is_pregnant,\n  Vet_clinic_name AS Vet_clinic_name,\n  Veterinary_name AS Veterinary_name,\n  Vet_address AS Vet_address,\n  Vet_city AS Vet_city,\n  Vet_state AS Vet_state,\n  Vet_zip AS Vet_zip,\n  Vet_phone_number AS Vet_phone_number,\n  monotonically_increasing_id() AS Monotonically_Increasing_Id\nFROM\n  Shortcut_to_Allivet_Daily_Invoice_0\"\"\")","df_1.createOrReplaceTempView(\"SQ_Shortcut_to_Allivet_Daily_Invoice_1\")"]},"id":"SQ_Shortcut_to_Allivet_Daily_Invoice","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Expression","label":"Exp_LoadTstmp","queries":["df_2 = spark.sql(\"\"\"SELECT\n  InvoicePostingDate AS i_InvoicePostingDate,\n  To_date(InvoicePostingDate, 'YYYY-MM-DD') AS o_InvoicePostingDate,\n  InvoiceCode AS InvoiceCode,\n  TransactionType AS TransactionType,\n  Allivet_Order AS Allivet_Order,\n  PetSmart_Order AS PetSmart_Order,\n  AllivetSku AS AllivetSku,\n  PetSmartSku AS PetSmartSku,\n  UPC AS UPC,\n  UnitsSold AS UnitsSold,\n  ProductCost AS ProductCost,\n  RetailPrice AS RetailPrice,\n  Manufacturer AS Manufacturer,\n  Brand AS Brand,\n  Title AS Title,\n  FreightFee AS FreightFee,\n  PackagingFee AS PackagingFee,\n  DispensingFee AS DispensingFee,\n  to_date(shipped_on, 'YYYY-MM-DD HH24:MI:SS.MS') AS o_shipped_on,\n  fulfillment_origin_zip_code AS fulfillment_origin_zip_code,\n  shipping_carrier AS shipping_carrier,\n  TrackingNumber AS TrackingNumber,\n  Customer_id AS Customer_id,\n  Pet_name AS Pet_name,\n  Pet_type AS Pet_type,\n  Breed_type AS Breed_type,\n  Pet_gender AS Pet_gender,\n  TO_DATE(pet_DOB, 'YYYY-MM-DD') AS o_pet_DOB,\n  Pet_weight AS Pet_weight,\n  Pet_allergy AS Pet_allergy,\n  Pet_medical_conditions AS Pet_medical_conditions,\n  IFF (\n    ISNULL(Pet_is_pregnant),\n    NULL,\n    IFF(\n      UPPER(Pet_is_pregnant) = 'Y',\n      1,\n      IFF(UPPER(Pet_is_pregnant) = 'N', 0)\n    )\n  ) AS o_Pet_is_pregnant,\n  Vet_clinic_name AS Vet_clinic_name,\n  Veterinary_name AS Veterinary_name,\n  Vet_address AS Vet_address,\n  Vet_city AS Vet_city,\n  Vet_state AS Vet_state,\n  Vet_zip AS Vet_zip,\n  Vet_phone_number AS Vet_phone_number,\n  now() AS LOAD_TSTMP,\n  Monotonically_Increasing_Id AS Monotonically_Increasing_Id\nFROM\n  SQ_Shortcut_to_Allivet_Daily_Invoice_1\"\"\")","df_2.createOrReplaceTempView(\"Exp_LoadTstmp_2\")"]},"id":"Exp_LoadTstmp","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Target Definition","label":"Shortcut_to_ALLIVET_DAILY_INVOICE_PRE","queries":["spark.sql(\"\"\"INSERT INTO\n  ALLIVET_DAILY_INVOICE_PRE_V2_test\nSELECT\n  o_InvoicePostingDate AS INVOICE_POSTING_DATE,\n  InvoiceCode AS INVOICE_CODE,\n  TransactionType AS TRANSACTION_TYPE,\n  Allivet_Order AS ALLIVET_ORDER_CODE,\n  AllivetSku AS ALLIVET_SKU,\n  PetSmart_Order AS PETSMART_ORDER_CODE,\n  PetSmartSku AS PETSMART_SKU,\n  UPC AS UPC,\n  UnitsSold AS UNITS_SOLD,\n  ProductCost AS PRODUCT_COST,\n  RetailPrice AS RETAIL_PRICE,\n  Manufacturer AS MANUFACTURER,\n  Brand AS BRAND,\n  Title AS TITLE,\n  FreightFee AS FREIGHT_FEE,\n  PackagingFee AS PACKAGING_FEE,\n  DispensingFee AS DISPENSING_FEE,\n  o_shipped_on AS SHIPPED_DATE,\n  fulfillment_origin_zip_code AS FULFILLMENT_ORIGIN_ZIP_CODE,\n  shipping_carrier AS SHIPPING_CARRIER,\n  TrackingNumber AS TRACKING_NUMBER,\n  Customer_id AS ALLIVET_CUSTOMER_ID,\n  Pet_name AS PET_NAME,\n  Pet_type AS PET_TYPE,\n  Breed_type AS BREED_TYPE,\n  Pet_gender AS PET_GENDER,\n  o_pet_DOB AS PET_DOB,\n  Pet_weight AS PET_WEIGHT,\n  Pet_allergy AS PET_ALLERGY,\n  Pet_medical_conditions AS PET_MEDICAL_CONDITIONS,\n  o_Pet_is_pregnant AS PET_IS_PREGNANT,\n  Vet_clinic_name AS VET_CLINIC_NAME,\n  Veterinary_name AS VETERINARY_NAME,\n  Vet_address AS VET_ADDRESS,\n  Vet_city AS VET_CITY,\n  Vet_state AS VET_STATE,\n  Vet_zip AS VET_ZIP,\n  Vet_phone_number AS VET_PHONE_NUMBER,\n  LOAD_TSTMP AS LOAD_TSTMP\nFROM\n  Exp_LoadTstmp_2\"\"\")"]},"id":"Shortcut_to_ALLIVET_DAILY_INVOICE_PRE","position":{"x":0,"y":0},"type":"normalNode"}]}