# Databricks notebook source
# COMMAND ----------

CREATE DATABASE IF NOT EXISTS DELTA_TRAINING;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.OMS_A_PAYMENT_TRANSACTION(OMS_PAYMENT_TRANSACTION_ID INT,
EXTERNAL_PAYMENT_TRANS_ID STRING,
COMPANY_ID INT,
PAYMENT_TRANS_TYPE INT,
PAYMENT_DETAIL_ID INT,
MERCH_ID STRING,
MERCH_PASSWORD STRING,
REQUESTED_AMOUNT INT,
REQUEST_ID STRING,
REQUEST_TOKEN STRING,
REQUESTED_DTTM TIMESTAMP,
FOLLOW_ON_ID STRING,
FOLLOW_ON_TOKEN STRING,
PROCESSED_AMOUNT INT,
TRANSACTION_DTTM TIMESTAMP,
TRANSACTION_EXP_DATE DATE,
NO_OF_TRIES_LEFT INT,
RECONCILLATION_ID STRING,
TRANS_RESP_DECISION INT,
TRANS_RESP_DECISION_DESC STRING,
EXTERNAL_RESPONSE_CODE STRING,
EXTERNAL_RESPONSE_MSG STRING,
RECORD_STATUS INT,
PROCESS_COUNT INT,
CREATED_SOURCE STRING,
CREATED_SOURCE_TYPE INT,
LAST_UPDATED_SOURCE STRING,
LAST_UPDATED_SOURCE_TYPE INT,
IS_DELETED INT,
COMBO_REQUESTED_ID STRING,
COMBO_REQUESTED_TOKEN STRING,
PAYMENT_PROCESS_PARAMETER INT,
BYPASS INT,
LAST_UPDATED_PROCESS STRING,
TRANS_RESP_DECISION_CODE STRING,
MERCH_SIGNATURE STRING,
FD_BANK_RESPONSE_CODE STRING,
IS_AUTHORIZED INT,
OMS_CREATED_DTTM TIMESTAMP,
OMS_LAST_UPDATED_DTTM TIMESTAMP,
UPDATED_DTTM TIMESTAMP,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.A_PAYMENT_DETAIL(PAYMENT_DETAIL_ID BIGINT,
EXTERNAL_PAYMENT_DETAIL_ID STRING,
COMPANY_ID BIGINT,
ENTITY_TYPE_ID BIGINT,
ENTITY_ID BIGINT,
ENTITY_NUMBER STRING,
CARD_TYPE_ID BIGINT,
CARD_NUMBER STRING,
CARD_DISPLAY_NUMBER STRING,
NAME_ON_CARD STRING,
CARD_EXP_MONTH BIGINT,
CARD_EXP_YEAR BIGINT,
BILL_TO_FIRST_NAME STRING,
BILL_TO_MIDDLE_NAME STRING,
BILL_TO_LAST_NAME STRING,
BILL_TO_ADDRESS_LINE1 STRING,
BILL_TO_ADDRESS_LINE2 STRING,
BILL_TO_CITY STRING,
BILLTO_STATE_PROV STRING,
BILL_TO_POSTAL_CODE STRING,
BILL_TO_COUNTRY_CODE STRING,
BILL_TO_PHONE_NUMBER STRING,
BILL_TO_EMAIL STRING,
SECURITY_CODE STRING,
REQ_AUTH_AMOUNT BIGINT,
REQ_SETTLEMENT_AMOUNT BIGINT,
REQ_REFUND_AMOUNT BIGINT,
CURRENCY_CODE STRING,
CHARGE_SEQUENCE BIGINT,
IS_COMPLETE BIGINT,
IS_SUSPENDED BIGINT,
CREATED_SOURCE STRING,
CREATED_SOURCE_TYPE BIGINT,
CREATED_DTTM TIMESTAMP,
LAST_UPDATED_SOURCE STRING,
LAST_UPDATED_SOURCE_TYPE BIGINT,
LAST_UPDATED_DTTM TIMESTAMP,
REF_FIELD1 STRING,
REF_FIELD2 STRING,
REF_FIELD3 STRING,
IS_DELETED BIGINT,
PAYMENT_METHOD BIGINT,
REF_FIELD4 STRING,
REF_FIELD5 STRING,
REF_FIELD6 STRING,
REF_FIELD7 STRING,
REF_FIELD8 STRING,
REF_FIELD9 STRING,
REF_FIELD10 STRING,
REF_NUM1 BIGINT,
REF_NUM2 BIGINT,
REF_NUM3 BIGINT,
REF_NUM4 BIGINT,
REF_NUM5 BIGINT,
PAYMENT_ENTRY_TYPE_ID BIGINT,
ACCOUNT_TYPE_ID BIGINT,
ROUTING_TRANSIT_NUMBER STRING,
ROUTING_DISPLAY_NUMBER STRING,
CHECK_NUMBER STRING,
DRIVERS_LICENSE_NUMBER STRING,
DRIVERS_LICENSE_STATE STRING,
DRIVERS_LICENSE_COUNTRY_CODE STRING,
BUSINESS_NAME STRING,
BUSINESS_TAX_ID STRING,
BILL_TO_ADDRESS_LINE3 STRING,
ORIG_ENTITY_NUMBER STRING) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.A_PAYMENT_TRANSACTION(PAYMENT_TRANSACTION_ID BIGINT,
EXTERNAL_PAYMENT_TRANS_ID STRING,
COMPANY_ID BIGINT,
PAYMENT_TRANS_TYPE BIGINT,
PAYMENT_DETAIL_ID BIGINT,
MERCH_ID STRING,
MERCH_PASSWORD STRING,
REQUESTED_AMOUNT BIGINT,
REQUEST_ID STRING,
REQUEST_TOKEN STRING,
REQUESTED_DTTM TIMESTAMP,
FOLLOW_ON_ID STRING,
FOLLOW_ON_TOKEN STRING,
PROCESSED_AMOUNT BIGINT,
TRANSACTION_DTTM TIMESTAMP,
TRANSACTION_EXP_DATE DATE,
NO_OF_TRIES_LEFT BIGINT,
RECONCILLATION_ID STRING,
TRANS_RESP_DECISION BIGINT,
TRANS_RESP_DECISION_DESC STRING,
EXTERNAL_RESPONSE_CODE STRING,
EXTERNAL_RESPONSE_MSG STRING,
RECORD_STATUS BIGINT,
PROCESS_COUNT BIGINT,
CREATED_SOURCE STRING,
CREATED_SOURCE_TYPE BIGINT,
CREATED_DTTM TIMESTAMP,
LAST_UPDATED_SOURCE STRING,
LAST_UPDATED_SOURCE_TYPE BIGINT,
LAST_UPDATED_DTTM TIMESTAMP,
IS_DELETED BIGINT,
COMBO_REQUESTED_ID STRING,
COMBO_REQUESTED_TOKEN STRING,
PAYMENT_PROCESS_PARAMETER BIGINT,
BYPASS BIGINT,
LAST_UPDATED_PROCESS STRING,
TRANS_RESP_DECISION_CODE STRING,
MERCH_SIGNATURE STRING,
FD_BANK_RESPONSE_CODE STRING,
IS_AUTHORIZED BIGINT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.OMS_A_PAYMENT_DETAIL(OMS_PAYMENT_DETAIL_ID INT,
OMS_ENTITY_TYPE_ID INT,
OMS_ENTITY_ID INT,
OMS_ENTITY_NBR STRING,
CARD_NUMBER STRING,
BILL_TO_FIRST_NAME STRING,
BILL_TO_MIDDLE_NAME STRING,
BILL_TO_LAST_NAME STRING,
BILL_TO_ADDR_LINE1 STRING,
BILL_TO_ADDR_LINE2 STRING,
BILL_TO_CITY STRING,
BILL_TO_STATE_PROV STRING,
BILL_TO_POSTAL_CD STRING,
BILL_TO_COUNTRY_CD STRING,
BILL_TO_PHONE_NBR STRING,
BILL_TO_EMAIL STRING,
OMS_PAYMENT_METHOD_ID INT,
AFTERPAY_FLG INT,
REQ_AUTH_AMT INT,
REQ_SETTLEMENT_AMT INT,
REQ_REFUND_AMT INT,
CURRENCY_CD STRING,
OMS_CREATED_TSTMP TIMESTAMP,
OMS_LAST_UPDATED_TSTMP TIMESTAMP,
UPDATE_TSTMP TIMESTAMP,
LOAD_TSTMP TIMESTAMP) USING DELTA;