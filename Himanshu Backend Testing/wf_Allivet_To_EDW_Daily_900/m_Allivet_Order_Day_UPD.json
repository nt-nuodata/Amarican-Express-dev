{"Edges":[{"id":"e-0","source":"Shortcut_to_ALLIVET_ORDER_DAY","target":"SQ_Shortcut_to_ALLIVET_ORDER_DAY","transformationType":"Source Qualifier"},{"id":"e-1","source":"SQ_Shortcut_to_ALLIVET_ORDER_DAY","target":"EXP_UPDATE_TSTMP","transformationType":"Expression"},{"id":"e-2","source":"EXP_UPDATE_TSTMP","target":"Shortcut_to_ALLIVET_ORDER_DAY1","transformationType":"Target Definition"}],"Nodes":[{"data":{"transformationType":"Source Definition","label":"Shortcut_to_ALLIVET_ORDER_DAY","queries":["df_0 = spark.sql(\"\"\"SELECT\n  ALLIVET_ORDER_NBR_V2_test AS ALLIVET_ORDER_NBR,\n  ALLIVET_ORDER_LN_NBR_V2_test AS ALLIVET_ORDER_LN_NBR,\n  ALLIVET_ORDER_DT AS ALLIVET_ORDER_DT,\n  PETSMART_ORDER_DT AS PETSMART_ORDER_DT,\n  ORDER_STATUS AS ORDER_STATUS,\n  PRODUCT_ID AS PRODUCT_ID,\n  PETSMART_ORDER_NBR AS PETSMART_ORDER_NBR,\n  PETSMART_SKU_NBR AS PETSMART_SKU_NBR,\n  ALLIVET_SKU_NBR AS ALLIVET_SKU_NBR,\n  SUB_TOTAL_AMT AS SUB_TOTAL_AMT,\n  FREIGHT_COST AS FREIGHT_COST,\n  TOTAL_AMT AS TOTAL_AMT,\n  SHIP_METHOD_CD AS SHIP_METHOD_CD,\n  ORDER_VOIDED_FLAG AS ORDER_VOIDED_FLAG,\n  ORDER_ONHOLD_FLAG AS ORDER_ONHOLD_FLAG,\n  ORDER_CREATED_DT AS ORDER_CREATED_DT,\n  ORDER_MODIFIED_DT AS ORDER_MODIFIED_DT,\n  SHIPPED_DT AS SHIPPED_DT,\n  ORDER_SHIPPED_FLAG AS ORDER_SHIPPED_FLAG,\n  INTERNAL_NOTES AS INTERNAL_NOTES,\n  PUBLIC_NOTES AS PUBLIC_NOTES,\n  AUTOSHIP_DISCOUNT_AMT AS AUTOSHIP_DISCOUNT_AMT,\n  ORDER_MERCHANT_NOTES AS ORDER_MERCHANT_NOTES,\n  RISKORDER_FLAG AS RISKORDER_FLAG,\n  RISK_REASON AS RISK_REASON,\n  ORIG_SHIP_METHOD_CD AS ORIG_SHIP_METHOD_CD,\n  SHIP_HOLD_FLAG AS SHIP_HOLD_FLAG,\n  SHIP_HOLD_DT AS SHIP_HOLD_DT,\n  SHIP_RELEASE_DT AS SHIP_RELEASE_DT,\n  ORDER_QTY AS ORDER_QTY,\n  ITEM_DESC AS ITEM_DESC,\n  EXT_PRICE AS EXT_PRICE,\n  ORDER_DETAIL_CREATED_DT AS ORDER_DETAIL_CREATED_DT,\n  ORDER_DETAIL_MODIFIED_DT AS ORDER_DETAIL_MODIFIED_DT,\n  HOW_TO_GET_RX AS HOW_TO_GET_RX,\n  VET_CD AS VET_CD,\n  PET_CD AS PET_CD,\n  ORDER_DETAIL_ONHOLD_FLAG AS ORDER_DETAIL_ONHOLD_FLAG,\n  ONHOLD_TO_FILL_FLAG AS ONHOLD_TO_FILL_FLAG,\n  UPDATE_TSTMP AS UPDATE_TSTMP,\n  LOAD_TSTMP AS LOAD_TSTMP\nFROM\n  ALLIVET_ORDER_DAY_V2_test\"\"\")","df_0.createOrReplaceTempView(\"Shortcut_to_ALLIVET_ORDER_DAY_0\")"]},"id":"Shortcut_to_ALLIVET_ORDER_DAY","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Qualifier","label":"SQ_Shortcut_to_ALLIVET_ORDER_DAY","queries":["df_1 = spark.sql(\"\"\"SELECT\n  ALLIVET_ORDER_NBR AS ALLIVET_ORDER_NBR,\n  ORDER_STATUS AS ORDER_STATUS,\n  monotonically_increasing_id() AS Monotonically_Increasing_Id\nFROM\n  (\n    SELECT\n      ALLIVET_ORDER_NBR,\n      ORDER_STATUS,\n      ROW_NUMBER() OVER (\n        PARTITION BY\n          ALLIVET_ORDER_NBR\n        ORDER BY\n          UPDATE_TSTMP DESC\n      ) RN\n    FROM\n      Shortcut_to_ALLIVET_ORDER_DAY_0\n    WHERE\n      ALLIVET_ORDER_NBR IN (\n        SELECT\n          ALLIVET_ORDER_NBR\n        FROM\n          (\n            SELECT\n              DISTINCT ALLIVET_ORDER_NBR,\n              ORDER_STATUS\n            FROM\n              Shortcut_to_ALLIVET_ORDER_DAY_0\n          ) A\n        GROUP BY\n          ALLIVET_ORDER_NBR\n        HAVING\n          COUNT(*) > 1\n      )\n  ) B\nWHERE\n  RN = 1\"\"\")","df_1.createOrReplaceTempView(\"SQ_Shortcut_to_ALLIVET_ORDER_DAY_1\")"]},"id":"SQ_Shortcut_to_ALLIVET_ORDER_DAY","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Expression","label":"EXP_UPDATE_TSTMP","queries":["df_2 = spark.sql(\"\"\"SELECT\n  ALLIVET_ORDER_NBR AS ALLIVET_ORDER_NBR,\n  ORDER_STATUS AS ORDER_STATUS,\n  now() AS UPDATE_TSTMP,\n  Monotonically_Increasing_Id AS Monotonically_Increasing_Id\nFROM\n  SQ_Shortcut_to_ALLIVET_ORDER_DAY_1\"\"\")","df_2.createOrReplaceTempView(\"EXP_UPDATE_TSTMP_2\")"]},"id":"EXP_UPDATE_TSTMP","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Target Definition","label":"Shortcut_to_ALLIVET_ORDER_DAY1","queries":["spark.sql(\"\"\"INSERT INTO\n  ALLIVET_ORDER_DAY_V2_test\nSELECT\n  ALLIVET_ORDER_NBR AS ALLIVET_ORDER_NBR,\n  NULL AS ALLIVET_ORDER_LN_NBR,\n  NULL AS ALLIVET_ORDER_DT,\n  NULL AS PETSMART_ORDER_DT,\n  ORDER_STATUS AS ORDER_STATUS,\n  NULL AS PRODUCT_ID,\n  NULL AS PETSMART_ORDER_NBR,\n  NULL AS PETSMART_SKU_NBR,\n  NULL AS ALLIVET_SKU_NBR,\n  NULL AS SUB_TOTAL_AMT,\n  NULL AS FREIGHT_COST,\n  NULL AS TOTAL_AMT,\n  NULL AS SHIP_METHOD_CD,\n  NULL AS ORDER_VOIDED_FLAG,\n  NULL AS ORDER_ONHOLD_FLAG,\n  NULL AS ORDER_CREATED_DT,\n  NULL AS ORDER_MODIFIED_DT,\n  NULL AS SHIPPED_DT,\n  NULL AS ORDER_SHIPPED_FLAG,\n  NULL AS INTERNAL_NOTES,\n  NULL AS PUBLIC_NOTES,\n  NULL AS AUTOSHIP_DISCOUNT_AMT,\n  NULL AS ORDER_MERCHANT_NOTES,\n  NULL AS RISKORDER_FLAG,\n  NULL AS RISK_REASON,\n  NULL AS ORIG_SHIP_METHOD_CD,\n  NULL AS SHIP_HOLD_FLAG,\n  NULL AS SHIP_HOLD_DT,\n  NULL AS SHIP_RELEASE_DT,\n  NULL AS ORDER_QTY,\n  NULL AS ITEM_DESC,\n  NULL AS EXT_PRICE,\n  NULL AS ORDER_DETAIL_CREATED_DT,\n  NULL AS ORDER_DETAIL_MODIFIED_DT,\n  NULL AS HOW_TO_GET_RX,\n  NULL AS VET_CD,\n  NULL AS PET_CD,\n  NULL AS ORDER_DETAIL_ONHOLD_FLAG,\n  NULL AS ONHOLD_TO_FILL_FLAG,\n  UPDATE_TSTMP AS UPDATE_TSTMP,\n  NULL AS LOAD_TSTMP\nFROM\n  EXP_UPDATE_TSTMP_2\"\"\")"]},"id":"Shortcut_to_ALLIVET_ORDER_DAY1","position":{"x":0,"y":0},"type":"normalNode"}]}