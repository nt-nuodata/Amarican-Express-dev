{"Edges":[{"id":"e-0","source":"Shortcut_to_Allivet_Daily_Order","target":"SQ_Shortcut_to_Allivet_Daily_Order","transformationType":"Source Qualifier"},{"id":"e-1","source":"SQ_Shortcut_to_Allivet_Daily_Order","target":"exp_load_tstmp","transformationType":"Expression"},{"id":"e-2","source":"exp_load_tstmp","target":"Shortcut_to_ALLIVET_DAILY_ORDER_PRE","transformationType":"Target Definition"}],"Nodes":[{"data":{"transformationType":"Source Definition","label":"Shortcut_to_Allivet_Daily_Order","queries":["df_0 = spark.sql(\"\"\"SELECT\n  AllivetOrderCode AS AllivetOrderCode,\n  PetsmartOrderCode AS PetsmartOrderCode,\n  AllivetOrderDate AS AllivetOrderDate,\n  PetsmartOrderDate AS PetsmartOrderDate,\n  Subtotal AS Subtotal,\n  Freight AS Freight,\n  Total AS Total,\n  ShippingMethodCode AS ShippingMethodCode,\n  OrderStatus AS OrderStatus,\n  IsVoided AS IsVoided,\n  IsOnHold AS IsOnHold,\n  SalesOrderDateCreated AS SalesOrderDateCreated,\n  SalesOrderDateModified AS SalesOrderDateModified,\n  DateShipped AS DateShipped,\n  IsShipped AS IsShipped,\n  InternalNotes AS InternalNotes,\n  PublicNotes AS PublicNotes,\n  AutoShip_DiscountAmount AS AutoShip_DiscountAmount,\n  OrderMerchantNotes AS OrderMerchantNotes,\n  IsRiskOrder AS IsRiskOrder,\n  RiskReasons AS RiskReasons,\n  OriginalShippingMethodCode AS OriginalShippingMethodCode,\n  IsShipHold AS IsShipHold,\n  DateShipHold AS DateShipHold,\n  DateShipReleased AS DateShipReleased,\n  AllivetSku AS AllivetSku,\n  PetsmartSku AS PetsmartSku,\n  LineNum AS LineNum,\n  QuantityOrdered AS QuantityOrdered,\n  ItemDescription AS ItemDescription,\n  ExtPrice AS ExtPrice,\n  CustomerSalesOrderDetailDateCreated AS CustomerSalesOrderDetailDateCreated,\n  CustomerSalesOrderDetailDateModified AS CustomerSalesOrderDetailDateModified,\n  HowdowegetyoutRx AS HowdowegetyoutRx,\n  VetCode AS VetCode,\n  PetCode AS PetCode,\n  IsOnHold1 AS IsOnHold1,\n  IsOnHoldToFill_C AS IsOnHoldToFill_C\nFROM\n  Allivet_Daily_Order\"\"\")","df_0.createOrReplaceTempView(\"Shortcut_to_Allivet_Daily_Order_0\")"]},"id":"Shortcut_to_Allivet_Daily_Order","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Qualifier","label":"SQ_Shortcut_to_Allivet_Daily_Order","queries":["df_1 = spark.sql(\"\"\"SELECT\n  AllivetOrderCode AS AllivetOrderCode,\n  PetsmartOrderCode AS PetsmartOrderCode,\n  AllivetOrderDate AS AllivetOrderDate,\n  PetsmartOrderDate AS PetsmartOrderDate,\n  Subtotal AS Subtotal,\n  Freight AS Freight,\n  Total AS Total,\n  ShippingMethodCode AS ShippingMethodCode,\n  OrderStatus AS OrderStatus,\n  IsVoided AS IsVoided,\n  IsOnHold AS IsOnHold,\n  SalesOrderDateCreated AS SalesOrderDateCreated,\n  SalesOrderDateModified AS SalesOrderDateModified,\n  DateShipped AS DateShipped,\n  IsShipped AS IsShipped,\n  InternalNotes AS InternalNotes,\n  PublicNotes AS PublicNotes,\n  AutoShip_DiscountAmount AS AutoShip_DiscountAmount,\n  OrderMerchantNotes AS OrderMerchantNotes,\n  IsRiskOrder AS IsRiskOrder,\n  RiskReasons AS RiskReasons,\n  OriginalShippingMethodCode AS OriginalShippingMethodCode,\n  IsShipHold AS IsShipHold,\n  DateShipHold AS DateShipHold,\n  DateShipReleased AS DateShipReleased,\n  AllivetSku AS AllivetSku,\n  PetsmartSku AS PetsmartSku,\n  LineNum AS LineNum,\n  QuantityOrdered AS QuantityOrdered,\n  ItemDescription AS ItemDescription,\n  ExtPrice AS ExtPrice,\n  CustomerSalesOrderDetailDateCreated AS CustomerSalesOrderDetailDateCreated,\n  CustomerSalesOrderDetailDateModified AS CustomerSalesOrderDetailDateModified,\n  HowdowegetyoutRx AS HowdowegetyoutRx,\n  VetCode AS VetCode,\n  PetCode AS PetCode,\n  IsOnHold1 AS IsOnHold1,\n  IsOnHoldToFill_C AS IsOnHoldToFill_C,\n  monotonically_increasing_id() AS Monotonically_Increasing_Id\nFROM\n  Shortcut_to_Allivet_Daily_Order_0\"\"\")","df_1.createOrReplaceTempView(\"SQ_Shortcut_to_Allivet_Daily_Order_1\")"]},"id":"SQ_Shortcut_to_Allivet_Daily_Order","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Expression","label":"exp_load_tstmp","queries":["df_2 = spark.sql(\"\"\"SELECT\n  AllivetOrderCode AS AllivetOrderCode,\n  PetsmartOrderCode AS PetsmartOrderCode,\n  TO_DATE(AllivetOrderDate, 'MM-DD-YYYY HH12:MI:SSAM') AS o_AllivetOrderDate,\n  TO_DATE(PetsmartOrderDate, 'MM-DD-YY HH24:MI') AS o_PetsmartOrderDate,\n  Subtotal AS Subtotal,\n  Freight AS Freight,\n  Total AS Total,\n  ShippingMethodCode AS ShippingMethodCode,\n  OrderStatus AS OrderStatus,\n  IFF(\n    Upper(IsVoided) = 'FALSE',\n    '0',\n    IFF(Upper(IsVoided) = 'TRUE', '1', IsVoided)\n  ) AS o_IsVoided,\n  IFF(\n    Upper(IsOnHold) = 'FALSE',\n    '0',\n    IFF(Upper(IsOnHold) = 'TRUE', '1', IsOnHold)\n  ) AS o_IsOnHold,\n  TO_DATE(SalesOrderDateCreated, 'MM-DD-YYYY HH12:MI:SSAM') AS o_SalesOrderDateCreated,\n  TO_DATE(SalesOrderDateModified, 'MM-DD-YYYY HH12:MI:SSAM') AS o_SalesOrderDateModified,\n  TO_DATE(DateShipped, 'MM-DD-YYYY HH12:MI:SSAM') AS o_DateShipped,\n  IFF(\n    Upper(IsShipped) = 'FALSE',\n    '0',\n    IFF(Upper(IsShipped) = 'TRUE', '1', IsShipped)\n  ) AS o_IsShipped,\n  InternalNotes AS InternalNotes,\n  PublicNotes AS PublicNotes,\n  AutoShip_DiscountAmount AS AutoShip_DiscountAmount,\n  OrderMerchantNotes AS OrderMerchantNotes,\n  IFF(\n    Upper(IsRiskOrder) = 'FALSE',\n    '0',\n    IFF(Upper(IsRiskOrder) = 'TRUE', '1', IsRiskOrder)\n  ) AS o_IsRiskOrder,\n  RiskReasons AS RiskReasons,\n  OriginalShippingMethodCode AS OriginalShippingMethodCode,\n  IFF(\n    Upper(IsShipHold) = 'FALSE',\n    '0',\n    IFF(Upper(IsShipHold) = 'TRUE', '1', IsShipHold)\n  ) AS o_IsShipHold,\n  TO_DATE(DateShipHold, 'MM-DD-YYYY HH12:MI:SSAM') AS o_DateShipHold,\n  TO_DATE(DateShipReleased, 'MM-DD-YYYY HH12:MI:SSAM') AS o_DateShipReleased,\n  AllivetSku AS AllivetSku,\n  PetsmartSku AS PetsmartSku,\n  LineNum AS LineNum,\n  QuantityOrdered AS QuantityOrdered,\n  ItemDescription AS ItemDescription,\n  ExtPrice AS ExtPrice,\n  TO_DATE(\n    CustomerSalesOrderDetailDateCreated,\n    'MM-DD-YYYY HH12:MI:SSAM'\n  ) AS o_CustomerSalesOrderDetailDateCreated,\n  TO_DATE(\n    CustomerSalesOrderDetailDateModified,\n    'MM-DD-YYYY HH12:MI:SSAM'\n  ) AS o_CustomerSalesOrderDetailDateModified,\n  HowdowegetyoutRx AS HowdowegetyoutRx,\n  VetCode AS VetCode,\n  PetCode AS PetCode,\n  IFF(\n    Upper(IsOnHold1) = 'FALSE',\n    '0',\n    IFF(Upper(IsOnHold1) = 'TRUE', '1', IsOnHold1)\n  ) AS IsShipHold,\n  IFF(\n    Upper(IsOnHoldToFill_C) = 'FALSE',\n    '0',\n    IFF(\n      Upper(IsOnHoldToFill_C) = 'TRUE',\n      '1',\n      IsOnHoldToFill_C\n    )\n  ) AS IsOnHoldToFill_C1,\n  now() AS LOAD_TSTMP,\n  Monotonically_Increasing_Id AS Monotonically_Increasing_Id\nFROM\n  SQ_Shortcut_to_Allivet_Daily_Order_1\"\"\")","df_2.createOrReplaceTempView(\"exp_load_tstmp_2\")"]},"id":"exp_load_tstmp","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Target Definition","label":"Shortcut_to_ALLIVET_DAILY_ORDER_PRE","queries":["spark.sql(\"\"\"INSERT INTO\n  ALLIVET_DAILY_ORDER_PRE_V2_test\nSELECT\n  AllivetOrderCode AS ALLIVET_ORDER_CODE,\n  LineNum AS ALLIVET_ORDER_LINE_NUMBER,\n  o_AllivetOrderDate AS ALLIVET_ORDER_DATE,\n  o_PetsmartOrderDate AS PETSMART_ORDER_DATE,\n  OrderStatus AS ORDER_STATUS,\n  PetsmartOrderCode AS PETSMART_ORDER_CODE,\n  Subtotal AS SUB_TOTAL,\n  Freight AS FREIGHT,\n  Total AS TOTAL,\n  ShippingMethodCode AS SHIPPING_METHOD_CODE,\n  o_IsVoided AS IS_ORDER_VOIDED,\n  o_IsOnHold AS IS_ORDER_ONHOLD,\n  o_SalesOrderDateCreated AS ORDER_CREATED_DATE,\n  o_SalesOrderDateModified AS ORDER_MODIFIED_DATE,\n  o_DateShipped AS SHIPPED_DATE,\n  o_IsShipped AS IS_ORDER_SHIPPED,\n  InternalNotes AS INTERNAL_NOTES,\n  PublicNotes AS PUBLIC_NOTES,\n  AutoShip_DiscountAmount AS AUTOSHIP_DISCOUNT_AMOUNT,\n  OrderMerchantNotes AS ORDER_MERCHANT_NOTES,\n  o_IsRiskOrder AS IS_RISKORDER,\n  RiskReasons AS RISK_REASONS,\n  OriginalShippingMethodCode AS ORIGINAL_SHIPPING_METHOD_CODE,\n  o_IsShipHold AS IS_SHIPHOLD,\n  o_DateShipHold AS SHIPHOLD_DATE,\n  o_DateShipReleased AS SHIPRELEASED_DATE,\n  AllivetSku AS ALLIVET_SKU,\n  PetsmartSku AS PETSMART_SKU,\n  QuantityOrdered AS ORDERED_QUANTITY,\n  ItemDescription AS ITEM_DESCRIPTION,\n  ExtPrice AS EXT_PRICE,\n  o_CustomerSalesOrderDetailDateCreated AS ORDER_DETAIL_CREATED_DATE,\n  o_CustomerSalesOrderDetailDateModified AS ORDER_DETAIL_MODIFIED_DATE,\n  HowdowegetyoutRx AS HOW_TO_GET_RX,\n  VetCode AS VET_CODE,\n  PetCode AS PET_CODE,\n  IsShipHold AS IS_ORDER_DETAIL_ONHOLD,\n  IsOnHoldToFill_C1 AS IS_ONHOLD_TOFILL,\n  LOAD_TSTMP AS LOAD_TSTMP\nFROM\n  exp_load_tstmp_2\"\"\")"]},"id":"Shortcut_to_ALLIVET_DAILY_ORDER_PRE","position":{"x":0,"y":0},"type":"normalNode"}]}