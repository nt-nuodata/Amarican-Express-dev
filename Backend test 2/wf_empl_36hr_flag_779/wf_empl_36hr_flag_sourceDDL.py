# Databricks notebook source
# MAGIC %sql
# MAGIC CREATE DATABASE IF NOT EXISTS DELTA_TRAINING;
# MAGIC
# MAGIC CREATE TABLE IF NOT EXISTS DELTA_TRAINING.EMPLOYEE_PROFILE_DAY(DAY_DT TIMESTAMP,
# MAGIC EMPLOYEE_ID INT,
# MAGIC EMPL_FIRST_NAME STRING,
# MAGIC EMPL_MIDDLE_NAME STRING,
# MAGIC EMPL_LAST_NAME STRING,
# MAGIC EMPL_BIRTH_DT TIMESTAMP,
# MAGIC GENDER_CD STRING,
# MAGIC PS_MARITAL_STATUS_CD STRING,
# MAGIC ETHNIC_GROUP_ID STRING,
# MAGIC EMPL_ADDR_1 STRING,
# MAGIC EMPL_ADDR_2 STRING,
# MAGIC EMPL_CITY STRING,
# MAGIC EMPL_STATE STRING,
# MAGIC EMPL_PROVINCE STRING,
# MAGIC EMPL_ZIPCODE STRING,
# MAGIC COUNTRY_CD STRING,
# MAGIC EMPL_HOME_PHONE STRING,
# MAGIC EMPL_EMAIL_ADDR STRING,
# MAGIC EMPL_LOGIN_ID STRING,
# MAGIC BADGE_NBR STRING,
# MAGIC EMPL_STATUS_CD STRING,
# MAGIC STATUS_CHG_DT TIMESTAMP,
# MAGIC FULLPT_FLAG STRING,
# MAGIC FULLPT_CHG_DT TIMESTAMP,
# MAGIC EMPL_TYPE_CD STRING,
# MAGIC PS_REG_TEMP_CD STRING,
# MAGIC EMPL_CATEGORY_CD STRING,
# MAGIC EMPL_GROUP_CD STRING,
# MAGIC EMPL_SUBGROUP_CD STRING,
# MAGIC EMPL_HIRE_DT TIMESTAMP,
# MAGIC EMPL_REHIRE_DT TIMESTAMP,
# MAGIC EMPL_TERM_DT TIMESTAMP,
# MAGIC TERM_REASON_CD STRING,
# MAGIC EMPL_SENORITY_DT TIMESTAMP,
# MAGIC PS_ACTION_DT TIMESTAMP,
# MAGIC PS_ACTION_CD STRING,
# MAGIC PS_ACTION_REASON_CD STRING,
# MAGIC LOCATION_ID INT,
# MAGIC LOCATION_CHG_DT TIMESTAMP,
# MAGIC STORE_NBR INT,
# MAGIC STORE_DEPT_NBR STRING,
# MAGIC COMPANY_ID INT,
# MAGIC PS_PERSONNEL_AREA_ID STRING,
# MAGIC PS_PERSONNEL_SUBAREA_ID STRING,
# MAGIC PS_DEPT_CD STRING,
# MAGIC PS_DEPT_CHG_DT TIMESTAMP,
# MAGIC PS_POSITION_ID INT,
# MAGIC POSITION_CHG_DT TIMESTAMP,
# MAGIC PS_SUPERVISOR_ID INT,
# MAGIC JOB_CODE INT,
# MAGIC JOB_CODE_CHG_DT TIMESTAMP,
# MAGIC EMPL_JOB_ENTRY_DT TIMESTAMP,
# MAGIC PS_GRADE_ID INT,
# MAGIC EMPL_STD_BONUS_PCT INT,
# MAGIC EMPL_OVR_BONUS_PCT INT,
# MAGIC EMPL_RATING INT,
# MAGIC PAY_RATE_CHG_DT TIMESTAMP,
# MAGIC PS_PAYROLL_AREA_CD STRING,
# MAGIC PS_TAX_COMPANY_CD STRING,
# MAGIC PS_COMP_FREQ_CD STRING,
# MAGIC COMP_RATE_AMT INT,
# MAGIC ANNUAL_RATE_LOC_AMT INT,
# MAGIC HOURLY_RATE_LOC_AMT INT,
# MAGIC CURRENCY_ID STRING,
# MAGIC EXCH_RATE_PCT INT,
# MAGIC LOAD_TSTMP TIMESTAMP) USING DELTA;
# MAGIC
# MAGIC CREATE TABLE IF NOT EXISTS DELTA_TRAINING.EMPL_EMPL_LOC_WK_PSOFT(WEEK_DT TIMESTAMP,
# MAGIC LOCATION_ID INT,
# MAGIC EMPLOYEE_ID INT,
# MAGIC EARN_ID STRING,
# MAGIC STORE_DEPT_NBR STRING,
# MAGIC JOB_CODE INT,
# MAGIC FULLPT_FLAG STRING,
# MAGIC HOURS_WORKED INT,
# MAGIC EARNINGS_AMT INT,
# MAGIC EARNINGS_LOC_AMT INT,
# MAGIC PAY_FREQ_CD STRING,
# MAGIC CURRENCY_NBR INT,
# MAGIC LOAD_TSTMP TIMESTAMP) USING DELTA;
# MAGIC
# MAGIC CREATE TABLE IF NOT EXISTS DELTA_TRAINING.EARNINGS_ID(EARN_ID STRING,
# MAGIC PS_TAX_COMPANY_CD STRING,
# MAGIC PS_WAGE_TYPE_GID INT,
# MAGIC PS_WAGE_TYPE_CD STRING,
# MAGIC PS_COUNTRY_GROUP_CD STRING,
# MAGIC PS_WAGE_TYPE_DESC STRING) USING DELTA;
# MAGIC
# MAGIC CREATE TABLE IF NOT EXISTS DELTA_TRAINING.EMPL_EMPL_LOC_WK(WEEK_DT TIMESTAMP,
# MAGIC LOCATION_ID INT,
# MAGIC EMPLOYEE_ID INT,
# MAGIC EARN_ID STRING,
# MAGIC STORE_DEPT_NBR STRING,
# MAGIC JOB_CODE INT,
# MAGIC FULLPT_FLAG STRING,
# MAGIC HOURS_WORKED INT,
# MAGIC EARNINGS_AMT INT,
# MAGIC EARNINGS_LOC_AMT INT,
# MAGIC PAY_FREQ_CD STRING,
# MAGIC CURRENCY_NBR INT,
# MAGIC LOAD_TSTMP TIMESTAMP) USING DELTA;
# MAGIC
# MAGIC CREATE TABLE IF NOT EXISTS DELTA_TRAINING.EMPLOYEE_PROFILE_DAY_PSOFT(DAY_DT TIMESTAMP,
# MAGIC EMPLOYEE_ID INT,
# MAGIC EMPL_FIRST_NAME STRING,
# MAGIC EMPL_MIDDLE_NAME STRING,
# MAGIC EMPL_LAST_NAME STRING,
# MAGIC EMPL_BIRTH_DT TIMESTAMP,
# MAGIC GENDER_CD STRING,
# MAGIC PS_MARITAL_STATUS_CD STRING,
# MAGIC ETHNIC_GROUP_ID STRING,
# MAGIC EMPL_ADDR_1 STRING,
# MAGIC EMPL_ADDR_2 STRING,
# MAGIC EMPL_CITY STRING,
# MAGIC EMPL_STATE STRING,
# MAGIC EMPL_PROVINCE STRING,
# MAGIC EMPL_ZIPCODE STRING,
# MAGIC COUNTRY_CD STRING,
# MAGIC EMPL_HOME_PHONE STRING,
# MAGIC EMPL_EMAIL_ADDR STRING,
# MAGIC EMPL_LOGIN_ID STRING,
# MAGIC BADGE_NBR STRING,
# MAGIC EMPL_STATUS_CD STRING,
# MAGIC STATUS_CHG_DT TIMESTAMP,
# MAGIC FULLPT_FLAG STRING,
# MAGIC FULLPT_CHG_DT TIMESTAMP,
# MAGIC EMPL_TYPE_CD STRING,
# MAGIC PS_REG_TEMP_CD STRING,
# MAGIC EMPL_CATEGORY_CD STRING,
# MAGIC EMPL_GROUP_CD STRING,
# MAGIC EMPL_SUBGROUP_CD STRING,
# MAGIC EMPL_HIRE_DT TIMESTAMP,
# MAGIC EMPL_REHIRE_DT TIMESTAMP,
# MAGIC EMPL_TERM_DT TIMESTAMP,
# MAGIC TERM_REASON_CD STRING,
# MAGIC EMPL_SENORITY_DT TIMESTAMP,
# MAGIC PS_ACTION_DT TIMESTAMP,
# MAGIC PS_ACTION_CD STRING,
# MAGIC PS_ACTION_REASON_CD STRING,
# MAGIC LOCATION_ID INT,
# MAGIC LOCATION_CHG_DT TIMESTAMP,
# MAGIC STORE_NBR INT,
# MAGIC STORE_DEPT_NBR STRING,
# MAGIC COMPANY_ID INT,
# MAGIC PS_PERSONNEL_AREA_ID STRING,
# MAGIC PS_PERSONNEL_SUBAREA_ID STRING,
# MAGIC PS_DEPT_CD STRING,
# MAGIC PS_DEPT_CHG_DT TIMESTAMP,
# MAGIC PS_POSITION_ID INT,
# MAGIC POSITION_CHG_DT TIMESTAMP,
# MAGIC PS_SUPERVISOR_ID INT,
# MAGIC JOB_CODE INT,
# MAGIC JOB_CODE_CHG_DT TIMESTAMP,
# MAGIC EMPL_JOB_ENTRY_DT TIMESTAMP,
# MAGIC PS_GRADE_ID INT,
# MAGIC EMPL_STD_BONUS_PCT INT,
# MAGIC EMPL_OVR_BONUS_PCT INT,
# MAGIC EMPL_RATING INT,
# MAGIC PAY_RATE_CHG_DT TIMESTAMP,
# MAGIC PS_PAYROLL_AREA_CD STRING,
# MAGIC PS_TAX_COMPANY_CD STRING,
# MAGIC PS_COMP_FREQ_CD STRING,
# MAGIC COMP_RATE_AMT INT,
# MAGIC ANNUAL_RATE_LOC_AMT INT,
# MAGIC HOURLY_RATE_LOC_AMT INT,
# MAGIC CURRENCY_ID STRING,
# MAGIC EXCH_RATE_PCT INT,
# MAGIC LOAD_TSTMP TIMESTAMP) USING DELTA;

# COMMAND ----------

# MAGIC %sql
# MAGIC SELECT
# MAGIC                 * 
# MAGIC             FROM
# MAGIC                 DELTA_TRAINING.EMPLOYEE_PROFILE_DAY 
# MAGIC             UNION
# MAGIC             SELECT
# MAGIC                 * 
# MAGIC             FROM
# MAGIC                 DELTA_TRAINING.EMPLOYEE_PROFILE_DAY_PSOFT 
# MAGIC             WHERE
# MAGIC                 DAY_DT > CAST('20101128' AS TIMESTAMP)

# COMMAND ----------


